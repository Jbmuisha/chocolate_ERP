{% extends 'layout.html' %}

{% block content %}
<div class="p-6 max-w-4xl mx-auto">
  <h2 class="text-2xl font-semibold text-rose-600 mb-4">Manage Users</h2>

  <form action="/add_user" method="POST" enctype="multipart/form-data" class="mb-6 space-y-4 bg-gray-50 p-4 rounded shadow">
    <h3 class="text-lg font-semibold">Add New User</h3>
    <div class="grid grid-cols-1 gap-4 sm:grid-cols-4">
      <input type="text" name="username" placeholder="Username" required class="border p-2 rounded" />
      <input type="password" name="password" placeholder="Password" required class="border p-2 rounded" />
      <select name="role" class="border p-2 rounded">
        <option value="employee">Employee</option>
        <option value="admin">Admin</option>
      </select>
      <input type="file" name="profile_image" accept="image/*" class="border p-2 rounded" />
    </div>
    <button type="submit" class="mt-2 bg-rose-600 text-white px-4 py-2 rounded">Add User</button>
  </form>

  {% if users %}
  <table class="min-w-full bg-white border rounded shadow-sm text-sm">
    <thead class="bg-gray-100">
      <tr>
        <th class="py-2 px-4 border-b">ID</th>
        <th class="py-2 px-4 border-b">Profile Image</th>
        <th class="py-2 px-4 border-b">Username</th>
        <th class="py-2 px-4 border-b">Role</th>
        <th class="py-2 px-4 border-b">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr class="border-t">
        <form action="/update_user/{{ user.id }}" method="POST" enctype="multipart/form-data" class="flex items-center space-x-2">
          <td class="py-2 px-4">{{ user.id }}</td>
          <td class="py-2 px-4">
            {% if user.image %}
            <img src="{{ url_for('static', filename='uploads/users/' ~ user.image) }}" alt="Profile Image" class="w-12 h-12 rounded-full object-cover" />
          {% else %}
            <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center text-gray-600 text-xs">No Image</div>
          {% endif %}
          <input type="file" name="image" accept="image/*" class="mt-1 w-full" />
          
           
          </td>
          <td class="py-2 px-4">
            <input type="text" name="username" value="{{ user.username }}" class="border p-1 w-full" />
          </td>
          <td class="py-2 px-4">
            <select name="role" class="border p-1 w-full">
              <option value="employee" {% if user.role == 'employee' %}selected{% endif %}>Employee</option>
              <option value="admin" {% if user.role == 'admin' %}selected{% endif %}>Admin</option>
            </select>
          </td>
          <td class="py-2 px-4 flex space-x-2">
            <button type="submit" class="text-blue-600">Save</button>
            <a href="/delete_user/{{ user.id }}" class="text-red-600" onclick="return confirm('Delete this user?')">Delete</a>
          </td>
        </form>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>No users found.</p>
  {% endif %}
</div>
{% endblock %}
