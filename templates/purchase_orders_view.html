{% extends 'layout.html' %} {% block content %}
<div class="max-w-6xl mx-auto my-12 p-6 bg-white shadow-lg rounded-lg">
  <h1 class="text-3xl font-bold mb-8 text-center">Purchase Orders</h1>

  {% if purchase_orders %}
  <table class="min-w-full border border-gray-300 rounded-lg shadow-sm mb-12">
    <thead class="bg-red-600 text-white">
      <tr>
        <th class="py-3 px-6 text-left">Order ID</th>
        <th class="py-3 px-6 text-left">Supplier</th>
        <th class="py-3 px-6 text-left">Total Amount</th>
        <th class="py-3 px-6 text-left">Date Ordered</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200">
      {% for order in purchase_orders %}
      <tr>
        <td class="py-3 px-6">{{ order.id }}</td>
        <td class="py-3 px-6">{{ order.supplier.name }}</td>
        <td class="py-3 px-6">${{ "%.2f"|format(order.total_amount) }}</td>
        <td class="py-3 px-6">{{ order.created_at.strftime('%Y-%m-%d') }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <h2 class="text-2xl font-semibold mb-4">Purchase Order Items</h2>

  {% for order in purchase_orders %}
  <div class="mb-8 border border-gray-300 rounded-md p-4 shadow-sm">
    <h3 class="font-semibold text-lg mb-2">
      Order ID: {{ order.id }} (Supplier: {{ order.supplier.name }})
    </h3>
    {% if order.items %}
    <table class="min-w-full border border-gray-300 rounded-lg shadow-sm">
      <thead class="bg-gray-200">
        <tr>
          <th class="py-2 px-4 text-left">Product</th>
          <th class="py-2 px-4 text-left">Quantity</th>
          <th class="py-2 px-4 text-left">Unit Price</th>
          <th class="py-2 px-4 text-left">Subtotal</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        {% for item in order.items %}
        <tr>
          <td class="py-2 px-4">{{ item.product.name }}</td>
          <td class="py-2 px-4">{{ item.quantity }}</td>
          <td class="py-2 px-4">${{ "%.2f"|format(item.unit_price) }}</td>
          <td class="py-2 px-4">
            ${{ "%.2f"|format(item.quantity * item.unit_price) }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="text-gray-600 italic">No items found for this order.</p>
    {% endif %}
  </div>
  {% endfor %} {% else %}
  <p class="text-center text-gray-600">No purchase orders found.</p>
  {% endif %}
</div>
{% endblock %}
